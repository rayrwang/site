<!DOCTYPE html>
<html>
    <head>
        <title>How Adam works: Brief Guide to Optimizers</title>
        <link rel="stylesheet" type="text/css" href="/assets/style.css">
        <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <link rel="icon" href="/images/icon.png" type="image/x-icon">
        <style>
            body {
                font-family: sans-serif
            }
            p, h1, h2, h3, h4, h5, h6 {
                margin-left: 100px;
                margin-right: 100px;
            }
            img {
                margin-left: 100px;
                margin-right: 100px;
            }
        </style>
    </head>

    <body>
        <div class="main-links">
            <a id="displayName" href="https://rayrwang.com">Raymond Wang</a>
            <br>
            <a href="https://rayrwang.com">Blog</a>
            <a href="https://rayrwang.com/about">About</a>
        </div>

        <!-- <p style="font-size: 30px; margin-bottom: 10px;"><strong>(not yet complete) How Adam works: Brief Guide to Optimizers</strong></p> -->
        <h1> (not yet complete) How Adam works: Brief Guide to Optimizers</h1>

        <h2>Neural Network:</h2>
        <p>Here's your neural network:</p>
        <p>\(
            \begin{align*}
            &l = f(\boldsymbol{x}, \boldsymbol{w}) \\
            &l : loss \\
            &f : neural\ net\ architecture \\
            &\boldsymbol{x} : data\ vector\ (both\ inputs\ and\ optional\ labels) \\
            &\boldsymbol{w} : vector\ of\ weights\ a.k.a. parameters
            \end{align*}
            \)</p>
        <h2>Gradient:</h2>
        <p>And here's your gradient:</p>
        <p>\(
            \begin{align*}
            &\boldsymbol{g} = \frac{dl}{d\boldsymbol{w}} \\
            &\boldsymbol{g} : gradient\ vector
            \end{align*}
            \)</p>
        <h2>Gradient descent:</h2>
        <p>Vanilla gradient descent. Parameters get updated using gradients to descend loss function.</p>
        <p>\(
            \begin{align*}
            &\boldsymbol{w} \leftarrow \boldsymbol{w} - a \boldsymbol{g} \\
            &a : learning\ rate
            \end{align*}
            \)</p>
        <h2>Other things to add:</h2>
        <p>To improve on vanilla gradient descent, there are basically two things we can do.<br>
            1. Change the loss function.<br>
            2. Change how we use the gradients.
        </p>
        <h2>1. Change the loss function.</h2>
        <h3>Weight decay</h3>
        <p>Weight decay is a regularization technique that incentivises weights to be close to \(0\) to prevent overfitting.
            This is done by adding the square of each weight to the loss.  
        </p>
        <p>Old loss function:</p>
        <p>\(
            \begin{align*}
            &l = f(\boldsymbol{x}, \boldsymbol{w}) \\
            \end{align*}
            \)</p>
        <p>New loss function:</p>
        <p>\(
            \begin{align*}
            &l = f(\boldsymbol{x}, \boldsymbol{w}) + b \sum_i w_i^2 \\
            &b : (hyperparameter)\ weight\ decay\ strength
            \end{align*}
            \)</p>
        <p>New gradient:</p>
        <p>\(
            \begin{align*}
            &\boldsymbol{g} = \frac{dl}{d\boldsymbol{w}} = \frac{d}{d \boldsymbol{w}} f(\boldsymbol{x}, \boldsymbol{w}) + 2 b \boldsymbol{w} \\
            \end{align*}
            \)</p>
        <p>The factor of \(2\) gets absorbed into the hyperparameter \(b\) for convenience.
        </p>
        <h2>2. Change how we use the gradients.</h2>
        <!-- <h3>Previous gradients</h3>
        <p>For the following, we will need to keep track of the gradient at previous timesteps.</p>
        <p>\(
            \begin{align*}
            &\boldsymbol{g_t} = Current\ gradient \\
            &\boldsymbol{g_{t-1}} = Gradient\ at\ previous\ timestep \\
            \end{align*}
            \)</p> -->
        <h3>Momentum</h3>

        <h2>Putting it all together: Adam</h2>
        <h2>AdamW</h2>
    </body>
</html>
