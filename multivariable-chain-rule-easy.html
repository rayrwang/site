<!DOCTYPE html>
<html>
    <head>
        <title>The Multivariable Chain Rule in 10 Minutes</title>
        <link rel="stylesheet" type="text/css" href="/assets/style.css">
        <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <link rel="icon" href="/images/icon.png" type="image/x-icon">
        <style>
            body {
                font-family: sans-serif
            }
            p {
                margin-left: 100px;
                margin-right: 100px;
            }
            img {
                margin-left: 100px;
                margin-right: 100px;
            }
        </style>
    </head>

    <body>
        <div class="main-links">
            <a id="displayName" href="https://rayrwang.com">Raymond Wang</a>
            <br>
            <a href="https://rayrwang.com">Blog</a>
            <a href="https://rayrwang.com/about">About</a>
        </div>

        <!-- <p style="font-size: 30px; margin-bottom: 10px;"><strong>The Multivariable Chain Rule in 10 Minutes</strong></p> -->
        <h1>The Multivariable Chain Rule in 10 Minutes</h1>

        <p>The multivariable chain rule is the main idea behind how the backpropagation algorithm works. Backprop is currently the most popular method for training neural networks.  </p>
        <p>It's a very simple concept.  </p>

        <p><strong>Basics</strong>  </p>
            <p>A function gets you from one variable to another.  </p>
            <img src="/images/single_to_single.svg">
            <p>\(b = b(a)\)  </p>
            <p>A function can take multiple variables as inputs, a "multivariable function."  </p>
            <img src="/images/many_to_one.svg">
            <p>\(c = c(a, b)\)  </p>
            <p>Relatedly, a variable can be the inputs for multiple functions.  </p>
            <img src="/images/one_to_two.svg">
            <p>\(
                \begin{align*}
                b = b(a) \\
                c = c(a)
                \end{align*}
                \)</p>
            <p>You can take derivatives of functions.</p>
            <img src="/images/one_to_one_back.svg">
            <p>\(
                \begin{align*}
                &b = b(a) \\
                &\frac{db}{da} = \frac{d}{da} b(a)
                \end{align*}
                \)</p>
            <p>And you can take partial derivatives of multivariable functions.
                The notation uses \(\partial\) instead of \(d\), but they work the same as derivatives of single variable functions.  
             </p>
            <img src="/images/two_to_two_back.svg">
            <p>\(
                \begin{align*}
                &c = c(a, b) \\
                &\frac{\partial c}{\partial a} = \frac{\partial}{\partial a} c(a, b) \\
                &\frac{\partial c}{\partial b} = \frac{\partial}{\partial b} c(a, b) \\
                \end{align*}
                \)</p>

        <p><strong>Three simple rules</strong>  </p>
            <p>The multivariable chain rule is essentially just three simple rules.  </p>
            <p>
                1. Derivatives along the same path multiply. (also known as the "chain rule" in single variable calculus)<br>
                2. Derivatives along different paths add.<br>
                3. You must account for all paths.  
            </p>

        <p><strong>Explanation of rule 1</strong>  </p>
            <p>Take the following chain of functions:</p>
            <img src="/images/chain.svg">
            <p>\(
                \begin{align*}
                &b = b(a) \\
                &c = c(b) \\
                \end{align*}
                \)</p>
            <p>In order to compute \(\frac{dc}{da}\),
                you multiply the derivatives of the middle two functions.  
            </p>
            <img src="/images/chain_back.svg">
            <p>\(
                \begin{align*}
                &\frac{dc}{da} = \frac{dc}{db} \frac{db}{da}
                \end{align*}
                \)</p>

        <p><strong>Explanation of rule 2</strong>  </p>
            <p>
                Take this example:
            </p>
            <img src="/images/adding.svg">
            <p>\(
                \begin{align*}
                &b = b(a) \\
                &c = c(a) \\
                &d = d(b, c)
                \end{align*}
                \)</p>
            <p>
                In this example, the derivatives from \(d\) come back together at \(a\).
            </p>
            <img src="/images/adding_back.svg">
            <p>
                To calculate \(\frac{d(d)}{da}\), you simply add the derivatives from the two paths.
            </p>
            <p>\(
                \begin{align*}
                &\frac{d(d)}{da} = \frac{\partial d}{\partial b} \frac{db}{da} + \frac{\partial d}{\partial c} \frac{dc}{da}
                \end{align*}
                \)</p>

        <p><strong>Explanation of rule 3</strong>  </p>
            <p>To follow from the previous example, you must account for both paths.
                Only calculating one path is not enough.
            </p>
            <img src="/images/adding.svg">
            <p>\(
                \begin{align*}
                &\frac{d(d)}{da} \neq \frac{\partial d}{\partial b} \frac{db}{da} \\
                &\frac{d(d)}{da} \neq \frac{\partial d}{\partial c} \frac{dc}{da}
                \end{align*}
                \)</p>
            <p>But, as shown above, accounting for both paths is correct.</p>
            <p>\(
                \begin{align*}
                &\frac{d(d)}{da} = \frac{\partial d}{\partial b} \frac{db}{da} + \frac{\partial d}{\partial c} \frac{dc}{da}
                \end{align*}
                \)</p>

        <p><strong>TODO Appendix</strong>  </p>
            <p>Example and verifying using PyTorch.  </p>
            <!-- <pre><code>
                import torch
            </code></pre> -->
    </body>
</html>
